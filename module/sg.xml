<?xml version="1.0" encoding="UTF-8"?>
<module modid="sg" path="..">
  <name>SGLib</name>
  <header-path path="include"/>
  <header-path path="keycode/include"/>
  <header-path path="libpce/include"/>
  <require module="glew"/>

  <defaults
      enable="jpeg png audio type"
      />

  <defaults
      os="osx"
      enable="app-cocoa jpeg-coregraphics png-coregraphics coreaudio
	      type-coretext"
      />

  <defaults
      os="linux"
      enable="app-gtk jpeg-libjpeg png-libpng alsa type-pango"
      />

  <defaults
      os="windows"
      enable="app-win32 jpeg-wincodec png-wincodec directsound
	      type-uniscribe"
      />

  <variant flag="app-win32">
    <name>Windows executable</name>
    <exe-suffix>Windows</exe-suffix>
    <exe-suffix os="windows"/>
    <require module="windows"/>
  </variant>

  <variant flag="app-cocoa">
    <name>Cocoa application</name>
    <exe-suffix>Cocoa</exe-suffix>
    <exe-suffix os="osx"/>
    <require module="osx/foundation osx/appkit
		     osx/corevideo opengl osx/carbon"/>
  </variant>

  <variant flag="app-gtk">
    <name>GTK executable</name>
    <exe-suffix>GTK</exe-suffix>
    <require module="gtk gtkglext"/>
  </variant>

  <variant flag="app-sdl">
    <name>SDL executable</name>
    <exe-suffix>SDL</exe-suffix>
    <require module="sdl"/>
  </variant>

  <feature flag="jpeg">
    <name>JPEG image support</name>
    <alternatives>
      <alt flag="jpeg-libjpeg">
	<name>LibJPEG JPEG support</name>
	<require module="libjpeg"/>
      </alt>
      <alt flag="jpeg-coregraphics">
	<name>Core Graphics JPEG support</name>
	<require module="osx/applicationservices"/>
      </alt>
      <alt flag="jpeg-wincodec">
	<name>WinCodec JPEG support</name>
	<require module="windows"/>
      </alt>
    </alternatives>
  </feature>

  <feature flag="png">
    <name>PNG image support</name>
    <alternatives>
      <alt flag="png-libpng">
	<name>LibPNG PNG support</name>
	<require module="libpng"/>
      </alt>
      <alt flag="png-coregraphics">
	<name>Core Graphics PNG support</name>
	<require module="osx/applicationservices"/>
      </alt>
      <alt flag="png-wincodec">
	<name>WinCodec PNG support</name>
	<require module="windows"/>
      </alt>
    </alternatives>
  </feature>

  <feature flag="audio">
    <name>Audio support</name>
    <alternatives>
      <alt flag="alsa">
	<name>ALSA sound output</name>
	<require module="alsa"/>
      </alt>
      <alt flag="coreaudio">
	<name>Core Audio sound output</name>
	<require module="osx/coreaudio osx/audiounit"/>
      </alt>
      <alt flag="directsound">
	<name>DirectSound sound output</name>
	<require module="windows"/>
      </alt>
    </alternatives>
  </feature>

  <feature flag="type">
    <name>Type rendering support</name>
    <alternatives>
      <alt flag="type-pango">
	<name>Pango type rendering</name>
	<require module="pango"/>
      </alt>
      <alt flag="type-coretext">
	<name>Core Text type rendering</name>
	<require module="osx/applicationservices"/>
      </alt>
      <alt flag="type-uniscribe">
	<name>Uniscribe type rendering</name>
	<require module="windows"/>
      </alt>
    </alternatives>
  </feature>

  <feature flag="video-recording">
    <name>Video recording support</name>
    <require module="posix"/>
  </feature>

  <!-- SGLib -->
  <group path="include/sg">
    <src path="audio_mixdown.h"/>
    <src path="audio_ofile.h"/>
    <src path="audio_pcm.h"/>
    <src path="audio_sample.h"/>
    <src path="audio_source.h"/>
    <src path="audio_system.h"/>
    <src path="clock.h"/>
    <src path="configfile.h"/>
    <src path="cvar.h"/>
    <src path="defs.h"/>
    <src path="dispatch.h"/>
    <src path="entry.h"/>
    <src path="error.h"/>
    <src path="event.h"/>
    <src path="file.h"/>
    <src path="log.h"/>
    <src path="model.h"/>
    <src path="net.h"/>
    <src path="opengl.h"/>
    <src path="pixbuf.h"/>
    <src path="rand.h"/>
    <src path="record.h"/>
    <src path="texture.h"/>
    <src path="type.h"/>
    <src path="version.h"/>
  </group>
  <group path="sg/audio">
    <src path="alsa.c"
	 enable="audio-alsa" module="alsa"/>
    <src path="convert.c"/>
    <src path="coreaudio.c"
	 enable="audio-coresound" module="osx/coreaudio osx/audiounit"/>
    <src path="directsound8.c"
	 enable="audio-directsound" module="windows"/>
    <src path="load.c"/>
    <src path="mixdown.c"/>
    <src path="ofile.c"/>
    <src path="pcm.c"/>
    <src path="resample.c"/>
    <src path="sample.c"/>
    <src path="source.c"/>
    <src path="sysprivate.h"/>
    <src path="system.c"/>
    <src path="wav.c"/>
  </group>
  <group path="sg/core">
    <src path="clock.c"/>
    <src path="clock_impl.h"/>
    <src path="configfile.c"/>
    <src path="configfile_read.c"/>
    <src path="cvar.c"/>
    <src path="error.c"/>
    <src path="model.c"/>
    <src path="net.c"/>
    <src path="opengl.c"/>
    <src path="rand.c"/>
    <src path="sys.c"/>
    <src path="texture.c"/>
    <src path="version.c"/>
    <!-- this file (version_const.c) is a bit magic, the path is hard
         coded and the file is generated by the build script -->
    <src path="version_const.c"/>
  </group>
  <group path="sg/dispatch">
    <src path="sync.c"/>
  </group>
  <group path="sg/file">
    <src path="impl.h"/>
    <src path="norm.c"/>
    <src path="path.c"/>
    <src path="posix.c" enable="posix"/>
    <src path="read.c"/>
    <src path="win.c" enable="windows"/>
  </group>
  <group path="sg/gtk"
	 enable="app-gtk" module="gtk gtkglext">
    <src path="gtk.c"/>
  </group>
  <group path="sg/log">
    <src path="console.c"/>
    <src path="impl.h"/>
    <src path="log.c"/>
    <src path="network.c"/>
  </group>
  <group path="sg/osx"
	 enable="app-cocoa" module="osx/appkit osx/foundation">
    <src path="GApplication.h"/>
    <src path="GApplication.m"/>
    <src path="GController.h"/>
    <src path="GController.m"/>
    <src path="GDisplay.h"/>
    <src path="GDisplay.m"/>
    <src path="GMain.m"/>
    <src path="GPrefix.h"/>
    <src path="GView.h"/>
    <src path="GView.m"/>
    <src path="GWindow.h"/>
    <src path="GWindow.m"/>
  </group>
  <group path="sg/pixbuf">
    <src path="coregraphics.c"
	 enable="jpeg-coregraphics" module="osx/applicationservices"/>
    <src path="libjpeg.c"
	 enable="jpeg-libjpeg" module="libjpeg"/>
    <src path="libpng.c"
	 enable="png-libpng" module="libpng"/>
    <src path="loadimage.c"/>
    <src path="pixbuf.c"/>
    <src path="premultiply_alpha.c"/>
    <src path="wincodec.cpp"
	 enable="jpeg-wincodec" module="windows"/>
  </group>
  <group path="sg/record">
    <src path="record.c"/>
    <src path="shot.c"/>
    <src path="vidproc.c" enable="video-recording"/>
    <src path="yuv.c" enable="video-recording"/>
  </group>
  <group path="sg/sdl"
	 enable="app-sdl" module="sdl">
    <src path="sdl.c"/>
  </group>
  <group path="sg/type">
    <src path="coretext.c"
	 enable="type-coretext" module="osx/applicationservices"/>
    <src path="impl.h"/>
    <src path="pango.c"
	 enable="type-pango" module="pango"/>
    <src path="type.c"/>
    <src path="uniscribe.c"
	 enable="type-uniscribe" module="windows"/>
  </group>
  <group path="sg/windows"
	 enable="app-win32" module="windows">
    <src path="windows.c"/>
  </group>
  <group path="sg/work">
    <src path="aio.c"/>
    <src path="dispatch.c"/>
    <src path="pthread.c" enable="posix"/>
    <src path="windows.c" enable="windows"/>
    <src path="work.h"/>
  </group>

  <!-- Keycode submodule -->
  <group path="keycode/include/keycode">
    <src path="keycode.h"/>
    <src path="keyid.h"/>
    <src path="keytable.h"/>
  </group>
  <group path="keycode/src">
    <src path="keyid.c"/>
    <src path="keytable_evdev.c" enable="linux"/>
    <src path="keytable_mac.c" enable="osx"/>
    <src path="keytable_win.c" enable="windows"/>
  </group>

  <!-- LibPCE submodule -->
  <group path="libpce/include/libpce">
    <src path="arch.h"/>
    <src path="atomic.h"/>
    <src path="attribute.h"/>
    <src path="byteorder.h"/>
    <src path="cpu.h"/>
    <src path="hash.h"/>
    <src path="hashtable.h"/>
    <src path="strbuf.h"/>
    <src path="thread.h"/>
    <src path="util.h"/>
  </group>
  <group path="libpce/lib">
    <src path="cpu.c"/>
    <src path="hash.c"/>
    <src path="hashtable.c"/>
    <src path="strbuf.c"/>
    <src path="thread_pthread.c" enable="posix"/>
    <src path="thread_windows.c" enable="posix"/>
  </group>
</module>
